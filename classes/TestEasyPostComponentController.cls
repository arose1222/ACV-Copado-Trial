@isTest
public class TestEasyPostComponentController {
    @isTest
    static void testGenerateLabel(){
        Test.setMock(HttpCalloutMock.class, new EasyPostMockCalloutBadCallBuyFail());
        Test.startTest();
        String addr = '{"zip":"14228","street":"12 Test St","state":"NY","name":"Account Bulk#A (Auction Buyer)","country":"US","city":"Buffalo"}';
        EasyPostComponentController epcc = new EasyPostComponentController(false);
        epcc.generateLabel(addr, true, null);
        Test.stopTest();
    }
       
    @isTest
    static void testFutureDate(){
        Test.startTest();
        EasyPostComponentController EPCC = new EasyPostComponentController(false);
        // During Daylight Savings time
        DateTime dtpre = DateTime.newInstanceGMT(2020, 9, 2, 21, 59, 59);  //2020 September 2, 5:59:59PM local
        EasyPostShipmentRequest.options Options = EPCC.futureDate(dtpre);
        System.assertEquals(0, Options.date_advance);

        dtpre = DateTime.newInstanceGMT(2020, 9, 2, 22, 00, 00);  //2020 September 2, 6:00:00PM local
        Options = EPCC.futureDate(dtpre);
        System.assertEquals(1, Options.date_advance);

        // During Daylight Savings time on Saturday
        dtpre = DateTime.newInstanceGMT(2020, 9, 5, 16, 59, 59);  //2020 September 5, 12:59:59PM local
        Options = EPCC.futureDate(dtpre);
        System.assertEquals(0, Options.date_advance);

        dtpre = DateTime.newInstanceGMT(2020, 9, 5, 17, 00, 00);  //2020 September 5, 1:00:00PM local
        Options = EPCC.futureDate(dtpre);
        System.assertEquals(2, Options.date_advance);

        // After Daylight Savings time
        dtpre = DateTime.newInstanceGMT(2021, 2, 3, 22, 59, 59);  //2021 February 3, 5:59:59PM local
        Options = EPCC.futureDate(dtpre);
        System.assertEquals(0, Options.date_advance);

        dtpre = DateTime.newInstanceGMT(2021, 2, 3, 23, 00, 00);  //2021 February 3, 6:00:00PM local
        Options = EPCC.futureDate(dtpre);
        System.assertEquals(1, Options.date_advance);

        // During Daylight Savings time on Saturday
        dtpre = DateTime.newInstanceGMT(2021, 2, 6, 17, 59, 59);  //2021 February 6, 12:59:59PM local
        Options = EPCC.futureDate(dtpre);
        System.assertEquals(0, Options.date_advance);

        dtpre = DateTime.newInstanceGMT(2021, 2, 6, 18, 00, 00);  //2021 February 6, 1:00:00PM local
        Options = EPCC.futureDate(dtpre);
        System.assertEquals(2, Options.date_advance);
        Test.stopTest();
    }

    @isTest
    static void testGettingBuyDataBuyFail(){
        Test.setMock(HttpCalloutMock.class, new EasyPostMockCalloutBadCallBuyFail());
        Test.startTest();
        //Buy Response
        EasyPostComponentController.GenerateShipping('{"company":"ACV Auctions","street1":"640 Ellicott St", "street2":"suite 321", "city":"Buffalo", "state":"NY", "county":"US", "zip":"14203", "phone":"8005534070"}')
;     
        Test.stopTest();
    }
    
        @isTest
    static void testGettingShipmentDataShipmentFail(){
        Test.setMock(HttpCalloutMock.class, new EasyPostMockCalloutBadCallShipmentFail());
        Test.startTest();
        //Buy Response
        EasyPostComponentController.GenerateShipping('{"company":"ACV Auctions","street1":"640 Ellicott St", "street2":"suite 321", "city":"Buffalo", "state":"NY", "county":"US", "zip":"14203", "phone":"8005534070"}')
;     
        Test.stopTest();
    }
    
    
   //Good Call. 
    @isTest
    static void testGettingShipmentData() {
        Test.setMock(HttpCalloutMock.class, new EasyPostMockCalloutGoodCall());
        Test.startTest();
        //Shipment Response
        EasyPostComponentController.GenerateShipping('{"company":"ACV Auctions","street1":"640 Ellicott St", "street2":"suite 321", "city":"Buffalo", "state":"NY", "county":"US", "zip":"14203", "phone":"8005534070"}')
;     
        Test.stopTest();
    }
    
    private class EasyPostMockCalloutGoodCall implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest req) {
            return TestEasyPostComponentController.processGoodResponse( req );
        }
    }
    
    public class EasyPostMockCalloutBadCall implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest req) {
            if(req.getEndpoint().endsWith('shipments')) {
               HTTPResponse res = new HTTPResponse();
                res.setHeader('Content-Type', 'application-json');
                res.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":null,"updated_at":"2019-03-25T15:43:24Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":null,"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":null,"tracker":null,"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}')
 ;
				res.setStatusCode(200);
                return res;
                
            } else if (req.getEndpoint().endsWith('buy')) {
                HTTPResponse res2 = new HTTPResponse();
                res2.setHeader('Content-Type', 'application-json');
                res2.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":"794668170255","updated_at":"2019-03-25T15:45:12Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":{"object":"PostageLabel","id":"pl_d49b7f74b0aa4713adc5a593172d42dd","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:12Z","date_advance":0,"integrated_form":"none","label_date":"2019-03-25T15:45:11Z","label_resolution":200,"label_size":"PAPER_4X6","label_type":"default","label_file_type":"image/png","label_url":"https://easypost-files.s3-us-west-2.amazonaws.com/files/postage_label/20190325/26c61759a83d41d1a1b9e9cee616ce47.png","label_pdf_url":null,"label_zpl_url":"https://easypost-files.s3-us-west-2.amazonaws.com/files/postage_label/20190325/26c61759a83d41d1a1b9e9cee616ce47.png","label_epl2_url":null,"label_file":null},"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:11Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},"tracker":{"id":"trk_7aabd49b684a49049c49f16279702853","object":"Tracker","mode":"test","tracking_code":"794668170255","status":"unknown","status_detail":"unknown","created_at":"2019-03-25T15:45:12Z","updated_at":"2019-03-25T15:45:12Z","signed_by":null,"weight":null,"est_delivery_date":null,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier":"FedEx","tracking_details":[],"fees":[],"carrier_detail":null,"public_url":"https://track.easypost.com/djE6dHJrXzdhYWJkNDliNjg0YTQ5MDQ5YzQ5ZjE2Mjc5NzAyODUz"},"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[{"object":"Fee","type":"LabelFee","amount":"0.01000","charged":true,"refunded":false}],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}')
;
				res2.setStatusCode(200);
				return res2;                
            } else {
                HTTPResponse res3 = new HTTPResponse();
                res3.setStatus('unexpected endpoint');
                System.assert(false, 'unexpected endpoint ' + req.getEndpoint());
                return res3;
        }
    }
}
    
    private class EasyPostMockCalloutBadCallShipmentFail implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest req) {
            if(req.getEndpoint().endsWith('shipments')) {
               HTTPResponse res = new HTTPResponse();
                res.setHeader('Content-Type', 'application-json');
                res.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":null,"updated_at":"2019-03-25T15:43:24Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":null,"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":null,"tracker":null,"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}')
 ;
				res.setStatusCode(500);
                return res;
                
            } else if (req.getEndpoint().endsWith('buy')) {
                HTTPResponse res2 = new HTTPResponse();
                res2.setHeader('Content-Type', 'application-json');
                res2.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":"794668170255","updated_at":"2019-03-25T15:45:12Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":{"object":"PostageLabel","id":"pl_d49b7f74b0aa4713adc5a593172d42dd","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:12Z","date_advance":0,"integrated_form":"none","label_date":"2019-03-25T15:45:11Z","label_resolution":200,"label_size":"PAPER_4X6","label_type":"default","label_file_type":"image/png","label_url":"https://easypost-files.s3-us-west-2.amazonaws.com/files/postage_label/20190325/26c61759a83d41d1a1b9e9cee616ce47.png","label_pdf_url":null,"label_zpl_url":null,"label_epl2_url":null,"label_file":null},"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:11Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},"tracker":{"id":"trk_7aabd49b684a49049c49f16279702853","object":"Tracker","mode":"test","tracking_code":"794668170255","status":"unknown","status_detail":"unknown","created_at":"2019-03-25T15:45:12Z","updated_at":"2019-03-25T15:45:12Z","signed_by":null,"weight":null,"est_delivery_date":null,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier":"FedEx","tracking_details":[],"fees":[],"carrier_detail":null,"public_url":"https://track.easypost.com/djE6dHJrXzdhYWJkNDliNjg0YTQ5MDQ5YzQ5ZjE2Mjc5NzAyODUz"},"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[{"object":"Fee","type":"LabelFee","amount":"0.01000","charged":true,"refunded":false}],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}')
;
				res2.setStatusCode(200);
				return res2;                
            } else {
                HTTPResponse res3 = new HTTPResponse();
                res3.setStatus('unexpected endpoint');
                System.assert(false, 'unexpected endpoint ' + req.getEndpoint());
                return res3;
        }
    }
}
      private class EasyPostMockCalloutBadCallBuyFail implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest req) {
            if(req.getEndpoint().endsWith('shipments')) {
               HTTPResponse res = new HTTPResponse();
                res.setHeader('Content-Type', 'application-json');
                res.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":null,"updated_at":"2019-03-25T15:43:24Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":null,"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD_OVERNIGHT","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":null,"tracker":null,"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}')
 ;
				res.setStatusCode(200);
                return res;
                
            } else if (req.getEndpoint().endsWith('buy')) {
                HTTPResponse res4 = new HTTPResponse();
                res4.setHeader('Content-Type', 'application-json');
                res4.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":"794668170255","updated_at":"2019-03-25T15:45:12Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":{"object":"PostageLabel","id":"pl_d49b7f74b0aa4713adc5a593172d42dd","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:12Z","date_advance":0,"integrated_form":"none","label_date":"2019-03-25T15:45:11Z","label_resolution":200,"label_size":"PAPER_4X6","label_type":"default","label_file_type":"image/png","label_url":"https://easypost-files.s3-us-west-2.amazonaws.com/files/postage_label/20190325/26c61759a83d41d1a1b9e9cee616ce47.png","label_pdf_url":null,"label_zpl_url":null,"label_epl2_url":null,"label_file":null},"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD_OVERNIGHT","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:11Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},"tracker":{"id":"trk_7aabd49b684a49049c49f16279702853","object":"Tracker","mode":"test","tracking_code":"794668170255","status":"unknown","status_detail":"unknown","created_at":"2019-03-25T15:45:12Z","updated_at":"2019-03-25T15:45:12Z","signed_by":null,"weight":null,"est_delivery_date":null,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier":"FedEx","tracking_details":[],"fees":[],"carrier_detail":null,"public_url":"https://track.easypost.com/djE6dHJrXzdhYWJkNDliNjg0YTQ5MDQ5YzQ5ZjE2Mjc5NzAyODUz"},"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[{"object":"Fee","type":"LabelFee","amount":"0.01000","charged":true,"refunded":false}],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}')
;
				res4.setStatusCode(500);
				return res4;                
            } else {
                HTTPResponse res3 = new HTTPResponse();
               // res3.setStatus('unexpected endpoint');
                System.assert(false, 'unexpected endpoint ' + req.getEndpoint());
                return res3;
        }
    }
}

    // Reusable for EasyPostAPI Test class
    public static HTTPResponse processGoodResponse( HTTPRequest req ) {
        if( req.getEndpoint().endsWith('shipments') ) {
               HTTPResponse res = new HTTPResponse();
                res.setHeader('Content-Type', 'application-json');
                res.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":null,"updated_at":"2019-03-25T15:43:24Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":null,"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD_OVERNIGHT","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":null,"tracker":null,"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}')
 ;
				res.setStatusCode(200);
                return res;
                
            } else if (req.getEndpoint().endsWith('buy')) {
                HTTPResponse res2 = new HTTPResponse();
                res2.setHeader('Content-Type', 'application-json');
                res2.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":"794668170255","updated_at":"2019-03-25T15:45:12Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":{"object":"PostageLabel","id":"pl_d49b7f74b0aa4713adc5a593172d42dd","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:12Z","date_advance":0,"integrated_form":"none","label_date":"2019-03-25T15:45:11Z","label_resolution":200,"label_size":"PAPER_4X6","label_type":"default","label_file_type":"image/png","label_url":"https://easypost-files.s3-us-west-2.amazonaws.com/files/postage_label/20190325/26c61759a83d41d1a1b9e9cee616ce47.png","label_pdf_url":null,"label_zpl_url":null,"label_epl2_url":null,"label_file":null},"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD_OVERNIGHT","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:11Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},"tracker":{"id":"trk_7aabd49b684a49049c49f16279702853","object":"Tracker","mode":"test","tracking_code":"794668170255","status":"unknown","status_detail":"unknown","created_at":"2019-03-25T15:45:12Z","updated_at":"2019-03-25T15:45:12Z","signed_by":null,"weight":null,"est_delivery_date":null,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier":"FedEx","tracking_details":[],"fees":[],"carrier_detail":null,"public_url":"https://track.easypost.com/djE6dHJrXzdhYWJkNDliNjg0YTQ5MDQ5YzQ5ZjE2Mjc5NzAyODUz"},"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[{"object":"Fee","type":"LabelFee","amount":"0.01000","charged":true,"refunded":false}],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}')
;
				res2.setStatusCode(200);
				return res2;                
            } else if ( req.getEndpoint().endsWith( 'ACVAuth' ) ) {
                HTTPResponse res4 = new HttpResponse();
                res4.setStatusCode(200);
                res4.setHeader('Content-Type', 'application-json');
                res4.setBody('{"returnMessage":"Success","originalRequest":{"auctionNumber":"001"},"easyPostReturn":{"trackingCode":"788274167188","link":"https://easypost-files.s3-us-west-2.amazonaws.com/files/postage_label/20190703/dfb4b62fc67d4fa5990f344b5f93d998.png"}}');
                return res4;
            } else if ( req.getEndpoint().contains( 'https://acv-api-prod.acvauctions.com/v2/title_status_updates/bulk' ) ) {
                HTTPResponse res5 = new HttpResponse();
                res5.setStatusCode(200);
                res5.setHeader('Content-Type', 'application-json');
                res5.setBody('{"status": "ok", "user_id": 123, "session_token": "TOKEN", "data": { "id": 123}}');
                return res5;
            } else if ( req.getEndpoint().endsWith( 'ZPL' ) ) {
                HTTPResponse res5 = new HttpResponse();
                res5.setStatusCode(200);
                res5.setHeader('Content-Type', 'application-json');
                res5.setBody('{"created_at":"2019-03-25T15:43:24Z","is_return":false,"messages":[],"mode":"test","options":{"currency":"USD","payment":{"type":"SENDER"},"label_date":null,"date_advance":0},"reference":null,"status":"unknown","tracking_code":"794668170255","updated_at":"2019-03-25T15:45:12Z","batch_id":null,"batch_status":null,"batch_message":null,"customs_info":null,"from_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"insurance":null,"order_id":null,"parcel":{"id":"prcl_e811c9bb2a194df881d756907306d176","object":"Parcel","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","length":null,"width":null,"height":null,"predefined_package":"FedExEnvelope","weight":10,"mode":"test"},"postage_label":{"object":"PostageLabel","id":"pl_d49b7f74b0aa4713adc5a593172d42dd","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:12Z","date_advance":0,"integrated_form":"none","label_date":"2019-03-25T15:45:11Z","label_resolution":200,"label_size":"PAPER_4X6","label_type":"default","label_file_type":"image/png","label_url":"https://easypost-files.s3-us-west-2.amazonaws.com/files/postage_label/20190325/26c61759a83d41d1a1b9e9cee616ce47.png","label_pdf_url":null,"label_zpl_url":null,"label_epl2_url":null,"label_file":null},"rates":[{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_cfd041158d484b439eb8bf5286900f9e","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"40.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"40.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_5557544d6854415c9d220cccafb3a403","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"STANDARD_OVERNIGHT","carrier":"FedEx","rate":"27.35","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"27.35","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T15:00:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_62d8d91fec984f0b9d598a6dcf41c77f","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY_AM","carrier":"FedEx","rate":"26.10","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"26.10","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T10:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_84aadd84162046cbb45377f9ed77de00","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_2_DAY","carrier":"FedEx","rate":"20.50","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"20.50","list_currency":"USD","delivery_days":2,"delivery_date":"2019-03-27T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":2,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},{"id":"rate_0e392ad219154576b919ee18efb90f2c","object":"Rate","created_at":"2019-03-25T15:43:25Z","updated_at":"2019-03-25T15:43:25Z","mode":"test","service":"FEDEX_EXPRESS_SAVER","carrier":"FedEx","rate":"8.65","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"8.65","list_currency":"USD","delivery_days":3,"delivery_date":"2019-03-28T16:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":3,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"}],"refund_status":null,"scan_form":null,"selected_rate":{"id":"rate_53ce5ae98d584a9d949b971e9b8f1d8b","object":"Rate","created_at":"2019-03-25T15:45:11Z","updated_at":"2019-03-25T15:45:11Z","mode":"test","service":"FIRST_OVERNIGHT","carrier":"FedEx","rate":"80.20","currency":"USD","retail_rate":null,"retail_currency":null,"list_rate":"80.20","list_currency":"USD","delivery_days":1,"delivery_date":"2019-03-26T08:30:00Z","delivery_date_guaranteed":true,"est_delivery_days":1,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier_account_id":"ca_45lusCky"},"tracker":{"id":"trk_7aabd49b684a49049c49f16279702853","object":"Tracker","mode":"test","tracking_code":"794668170255","status":"unknown","status_detail":"unknown","created_at":"2019-03-25T15:45:12Z","updated_at":"2019-03-25T15:45:12Z","signed_by":null,"weight":null,"est_delivery_date":null,"shipment_id":"shp_e60d045467db4fdc8589221cc666a362","carrier":"FedEx","tracking_details":[],"fees":[],"carrier_detail":null,"public_url":"https://track.easypost.com/djE6dHJrXzdhYWJkNDliNjg0YTQ5MDQ5YzQ5ZjE2Mjc5NzAyODUz"},"to_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"usps_zone":4,"return_address":{"id":"adr_986e63f1c43c444bbb084d5899877f9e","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":null,"company":"ACV Auctions, Inc","street1":"640 Ellicott St","street2":"Suite 321","city":"Buffalo","state":"NY","zip":"14203","country":"US","phone":"8005534070","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"buyer_address":{"id":"adr_276f233fcc2147de8a6e9661dc2f1f1a","object":"Address","created_at":"2019-03-25T15:43:24Z","updated_at":"2019-03-25T15:43:24Z","name":"K & S Auto Brokers, Inc.","company":null,"street1":"2875 Cherry Road","street2":"","city":"Rock Hill","state":"SC","zip":"29730","country":"US","phone":"8038100424","email":null,"mode":"test","carrier_facility":null,"residential":null,"federal_tax_id":null,"state_tax_id":null,"verifications":{}},"forms":[],"fees":[{"object":"Fee","type":"LabelFee","amount":"0.01000","charged":true,"refunded":false}],"id":"shp_e60d045467db4fdc8589221cc666a362","object":"Shipment"}');
                return res5;
            }
            HTTPResponse res3 = new HTTPResponse();
            res3.setStatus('unexpected endpoint');
            System.assert(false, 'unexpected endpoint ' + req.getEndpoint());
            return res3;
    }

}